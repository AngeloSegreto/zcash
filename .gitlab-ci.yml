stages:
  - build
  - test
  - stage_site
  - deploy
  - cleanup

before_script:
  - apk add git make
  
build_job:
  image: python:3.6-alpine
  stage: build
  script:
  - pip install sphinx sphinx_rtd_theme sphinx-autobuild sphinx_fontawesome
  - git clone https://gitlab.com/mdr0id/test-rtd-docs.git
  - cd test-rtd-docs/
  - make html
  
test_job:
  image: python:3.6-alpine
  stage: test
  script: 
  - print "test_job not implemented"
  allow_failure: true
  
pages:
  image: python:3.6-alpine
  stage: stage_site
  script:
  - pip install sphinx sphinx_rtd_theme sphinx-autobuild sphinx_fontawesome
  - git clone https://gitlab.com/mdr0id/test-rtd-docs.git
  - cd test-rtd-docs/
  - make html
  - mv build/html public
  artifacts:
        paths:
        - public
  only:
  - master
  
deploy_job:
  image: python:3.6-alpine
  stage: deploy
  script: 
  - print "deploy_job not implemented"
  allow_failure: true

cleanup_job:
  image: python:3.6-alpine
  stage: cleanup
  script: 
  - print "cleanup_job not implemented"
  allow_failure: true